{% comment %}
  Custom Variant Picker with Images
{% endcomment %}

{%- unless product.has_only_default_variant -%}
  <style>
    .variant-image-swatch {
      width: 60px;
      height: 60px;
      border-radius: 8px;
      object-fit: cover;
      border: 2px solid transparent;
      cursor: pointer;
      transition: border 0.2s;
    }
    .variant-image-swatch.selected {
      border-color: #000;
    }
  </style>

  <variant-selects
    id="variant-selects-{{ section.id }}"
    data-section="{{ section.id }}"
    {{ block.shopify_attributes }}
  >
    {% for option in product.options_with_values %}
      {% if option.name == 'Color' %}
        <fieldset class="product-form__input product-form__input--swatch">
          <legend class="form__label">{{ option.name }}</legend>
          <div class="variant-image-picker">
            {% for value in option.values %}
              {% assign image_url = '' %}
              {% case value %}
                {% when 'Gray Camel' %}{% assign image_url = 'https://cdn.shopify.com/s/files/1/0906/5388/4802/files/Padelism_GrAD_2_-_Gray_Camel.png?v=1745079967' %}
                {% when 'Navy' %}{% assign image_url = 'https://cdn.shopify.com/s/files/1/0906/5388/4802/files/Padelism_GrAD_2_-_Navy.png?v=1745079949' %}
                {% when 'Sand Color' %}{% assign image_url = 'https://cdn.shopify.com/s/files/1/0906/5388/4802/files/Padelism_GrAD_2_-_Sand_Color.png?v=1745079773' %}
                {% when 'Oat Grey' %}{% assign image_url = 'https://cdn.shopify.com/s/files/1/0906/5388/4802/files/Padelism_GrAD_2_-_Oat_Grey.png?v=1745079752' %}
                {% when 'Black' %}{% assign image_url = 'https://cdn.shopify.com/s/files/1/0906/5388/4802/files/Padelism_GrAD_2_-_Black.png?v=1745079737' %}
                {% when 'White' %}{% assign image_url = 'https://cdn.shopify.com/s/files/1/0906/5388/4802/files/Padelism_GrAD_2_-_White.png?v=1745079912' %}
              {% endcase %}

              <img
                src="{{ image_url }}"
                alt="{{ value }}"
                class="variant-image-swatch {% if value == option.selected_value %}selected{% endif %}"
                data-value="{{ value }}"
              >
            {% endfor %}
          </div>
          <input type="hidden" name="options[{{ option.name }}]" value="{{ option.selected_value }}">
        </fieldset>
      {% else %}
        <fieldset class="product-form__input">
          <legend class="form__label">{{ option.name }}</legend>
          <select name="options[{{ option.name }}]">
            {% for value in option.values %}
              <option
                value="{{ value }}"
                {% if value == option.selected_value %}selected{% endif %}
              >
                {{ value }}
              </option>
            {% endfor %}
          </select>
        </fieldset>
      {% endif %}
    {% endfor %}

    <script type="application/json" data-selected-variant>
      {{ product.selected_or_first_available_variant | json }}
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".variant-image-picker img").forEach(function (img) {
          img.addEventListener("click", function () {
            const selectedValue = this.getAttribute("data-value");
            const input = this.closest("fieldset").querySelector("input[type='hidden']");
            input.value = selectedValue;

            // Highlight selected image
            this.closest(".variant-image-picker").querySelectorAll("img").forEach(el => el.classList.remove("selected"));
            this.classList.add("selected");

            // Trigger change event for Shopifyâ€™s JS to update
            input.dispatchEvent(new Event("change", { bubbles: true }));
          });
        });
      });
    </script>
  </variant-selects>
{%- endunless -%}
