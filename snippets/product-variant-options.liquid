{% comment %}
  Product variant picker with variant images instead of swatch pills.
  This works for options like "Color" where each variant has a different featured image.
{% endcomment %}

{%- liquid
  assign product_form_id = 'product-form-' | append: section.id
-%}

<div class="variant-thumbs-wrap" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 0;">
  {%- for value in option.values -%}
    {%- assign matching_variant = product.variants | where: option.name, value | first -%}

    {%- if matching_variant and matching_variant.featured_image -%}
      {%- capture input_id -%}
        {{ section.id }}-{{ option.position }}-{{ forloop.index0 }}
      {%- endcapture -%}

      <label for="{{ input_id }}" class="variant-thumb-label">
        <input
          type="radio"
          id="{{ input_id }}"
          name="options[{{ option.name }}]"
          value="{{ value | escape }}"
          form="{{ product_form_id }}"
          class="variant-thumb-input"
          {% if value == option.selected_value %}checked{% endif %}
          style="display: none;"
          data-product-url="{{ matching_variant.url }}"
        >
        <img
          src="{{ matching_variant.featured_image | image_url: width: 120 }}"
          alt="{{ value }}"
          class="variant-thumb-img"
        >
      </label>
    {%- endif -%}
  {%- endfor -%}
</div>

<style>
  .variant-thumb-label {
    display: inline-block;
    border: 2px solid transparent;
    border-radius: 4px;
    padding: 2px;
    transition: border 0.2s ease;
  }

  .variant-thumb-img {
    width: 80px;
    height: 80px;
    object-fit: cover;
    display: block;
    border-radius: 4px;
  }

  .variant-thumb-input:checked + .variant-thumb-img,
  .variant-thumb-label input[type="radio"]:checked + img {
    border: 2px solid black;
  }
</style>
